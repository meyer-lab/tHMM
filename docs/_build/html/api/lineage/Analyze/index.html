<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lineage.Analyze &mdash; tHMM 1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> tHMM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../system-reqs.html">System Requirements</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../demo.html">Demo and Instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../stateDistributions.html">State Distributions - How to create</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">tHMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">lineage.Analyze</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/api/lineage/Analyze/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-lineage.Analyze">
<span id="lineage-analyze"></span><h1><a class="reference internal" href="#module-lineage.Analyze" title="lineage.Analyze"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lineage.Analyze</span></code></a><a class="headerlink" href="#module-lineage.Analyze" title="Permalink to this headline"></a></h1>
<p>Calls the tHMM functions and outputs the parameters needed to generate the Figures.</p>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline"></a></h3>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.Analyze.DummyExecutor" title="lineage.Analyze.DummyExecutor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DummyExecutor</span></code></a></p></td>
<td><p>This is an abstract base class for concrete asynchronous executors.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.Analyze.Analyze" title="lineage.Analyze.Analyze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analyze</span></code></a>(X, num_states, **kwargs)</p></td>
<td><p>Runs the model and outputs the tHMM object, state assignments, and likelihood.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lineage.Analyze.Analyze_list" title="lineage.Analyze.Analyze_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Analyze_list</span></code></a>(Population_list, num_states, **kwargs)</p></td>
<td><p>This function runs the analyze for the case when we want to fit multiple conditions at the same time.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.Analyze.run_Analyze_over" title="lineage.Analyze.run_Analyze_over"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_Analyze_over</span></code></a>(list_of_populations, num_states, parallel=True, atonce=False, **kwargs)</p></td>
<td><p>A function that can be parallelized to speed up figure creation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lineage.Analyze.Results" title="lineage.Analyze.Results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Results</span></code></a>(tHMMobj, pred_states_by_lineage, LL)</p></td>
<td><p>This function calculates several results of fitting a synthetic lineage and stores it in a dictionary.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.Analyze.run_Results_over" title="lineage.Analyze.run_Results_over"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_Results_over</span></code></a>(output, parallel=True)</p></td>
<td><p>A function that can be parallelized to speed up figure creation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lineage.Analyze.permute_states" title="lineage.Analyze.permute_states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">permute_states</span></code></a>(tHMMobj, switch_map)</p></td>
<td><p>This function takes the tHMMobj and the predicted states,</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="lineage.Analyze.DummyExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">DummyExecutor</span></span><a class="headerlink" href="#lineage.Analyze.DummyExecutor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">concurrent.futures.Executor</span></code></p>
<p>This is an abstract base class for concrete asynchronous executors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lineage.Analyze.DummyExecutor.submit">
<span class="sig-name descname"><span class="pre">submit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.DummyExecutor.submit" title="Permalink to this definition"></a></dt>
<dd><p>Submits a callable to be executed with the given arguments.</p>
<p>Schedules the callable to be executed as fn(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs) and returns
a Future instance representing the execution of the callable.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>A Future representing the given call.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.Analyze">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">Analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.Analyze" title="Permalink to this definition"></a></dt>
<dd><p>Runs the model and outputs the tHMM object, state assignments, and likelihood.
:param X: The list of LineageTree populations.
:param num_states: The number of states that we want to run the model for.
:return tHMMobj_list: The tHMMobj after fitting corresponding to the given LineageTree population.
:return st: The nested list of states assigned to cells, with the order of cells from root to leaf in each lineage, and generation.
:return LL: The log-likelihood of the fitted model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em>) -- </p></li>
<li><p><strong>num_states</strong> (<em>int</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[object, int, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.Analyze_list">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">Analyze_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Population_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.Analyze_list" title="Permalink to this definition"></a></dt>
<dd><p>This function runs the analyze for the case when we want to fit multiple conditions at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Population_list</strong> (<em>list</em>) -- </p></li>
<li><p><strong>num_states</strong> (<em>int</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[list, list, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.run_Analyze_over">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">run_Analyze_over</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_populations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atonce</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.run_Analyze_over" title="Permalink to this definition"></a></dt>
<dd><p>A function that can be parallelized to speed up figure creation.</p>
<p>This function is the outermost for-loop we will end up using
when analyzing heterogenous populations or lineages.</p>
<p>Analyze is the bottleneck in the figure creation process. The
rest of the code involved in figure creation deals with collecting
and computing certain statistics, most of which can be done in an
additional for loop over the results from Analyze.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_of_populations</strong> (<em>list</em>) -- </p></li>
<li><p><strong>num_states</strong> (<em>numpy.ndarray</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.Results">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">Results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tHMMobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_states_by_lineage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LL</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.Results" title="Permalink to this definition"></a></dt>
<dd><p>This function calculates several results of fitting a synthetic lineage and stores it in a dictionary.
The dictionary contains the total number of lineages, the log likelihood of state assignments, and
the total number of cells. It also contains metrics such as the accuracy of state assignment predictions,
the distance between two distributions, and the Wasserstein distance between two states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pred_states_by_lineage</strong> (<em>list</em>) -- </p></li>
<li><p><strong>LL</strong> (<em>float</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.run_Results_over">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">run_Results_over</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.run_Results_over" title="Permalink to this definition"></a></dt>
<dd><p>A function that can be parallelized to speed up figure creation.
Output is a list of tuples from the results of running <a class="reference internal" href="#lineage.Analyze.run_Analyze_over" title="lineage.Analyze.run_Analyze_over"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_Analyze_over()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>output</strong> (<em>list</em>) -- </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.Analyze.permute_states">
<span class="sig-prename descclassname"><span class="pre">lineage.Analyze.</span></span><span class="sig-name descname"><span class="pre">permute_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tHMMobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">switch_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.Analyze.permute_states" title="Permalink to this definition"></a></dt>
<dd><p>This function takes the tHMMobj and the predicted states,
and finds out whether we need to switch the state identities or not based on the likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tHMMobj</strong> (<em>Any</em>) -- </p></li>
<li><p><strong>switch_map</strong> (<em>numpy.array</em>) -- </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[Any, list]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Farnaz Mohammadi, JC Lagarde, Aaron S Meyer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
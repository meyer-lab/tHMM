<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lineage.states.StateDistributionGamma &mdash; tHMM 1.0 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../../index.html" class="icon icon-home"> tHMM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../overview.html">Summary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../Installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../system-reqs.html">System Requirements</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../demo.html">Demo and Instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../stateDistributions.html">State Distributions - How to create</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">tHMM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">lineage.states.StateDistributionGamma</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/technical/api/lineage/states/StateDistributionGamma/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-lineage.states.StateDistributionGamma">
<span id="lineage-states-statedistributiongamma"></span><h1><a class="reference internal" href="#module-lineage.states.StateDistributionGamma" title="lineage.states.StateDistributionGamma"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lineage.states.StateDistributionGamma</span></code></a><a class="headerlink" href="#module-lineage.states.StateDistributionGamma" title="Permalink to this headline"></a></h1>
<p>This file is completely user defined. We have provided a general starting point for the user to use as an example.</p>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline"></a></h3>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.states.StateDistributionGamma.StateDistribution" title="lineage.states.StateDistributionGamma.StateDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateDistribution</span></code></a></p></td>
<td><p>StateDistribution for cells with gamma distributed times.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.states.StateDistributionGamma.fate_censor" title="lineage.states.StateDistributionGamma.fate_censor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fate_censor</span></code></a>(cell)</p></td>
<td><p>Checks whether a cell has died based on its fate, and if so, it will remove its subtree.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#lineage.states.StateDistributionGamma.time_censor" title="lineage.states.StateDistributionGamma.time_censor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_censor</span></code></a>(cell, desired_experiment_time)</p></td>
<td><p>Checks whether a cell has lived beyond the experiment end time and if so, it will remove its subtree.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#lineage.states.StateDistributionGamma.atonce_estimator" title="lineage.states.StateDistributionGamma.atonce_estimator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atonce_estimator</span></code></a>(all_tHMMobj, x_list, gammas_list, phase, state_j)</p></td>
<td><p>Estimating the parameters for one state, in this case bernoulli nad gamma distirbution parameters,</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lineage.states.StateDistributionGamma.</span></span><span class="sig-name descname"><span class="pre">StateDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bern_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution" title="Permalink to this definition"></a></dt>
<dd><p>StateDistribution for cells with gamma distributed times.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.rvs">
<span class="sig-name descname"><span class="pre">rvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.rvs" title="Permalink to this definition"></a></dt>
<dd><p>User-defined way of calculating a random variable given the parameters of the state stored in their object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>size</strong> (<em>int</em>) -- </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.dist">
<span class="sig-name descname"><span class="pre">dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.dist" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Wasserstein distance between two gamma distributions that each correspond to a state.
This is our way of calculating the distance between two state, when their bernoulli distribution is kept the same.
For more information about wasserstein distance, please see <a class="reference external" href="https://en.wikipedia.org/wiki/Wasserstein_metric">https://en.wikipedia.org/wiki/Wasserstein_metric</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.dof">
<span class="sig-name descname"><span class="pre">dof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.dof" title="Permalink to this definition"></a></dt>
<dd><p>Return the degrees of freedom.
In this case, each state has 1 bernoulli distribution parameter, and 2 gamma distribution parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.pdf" title="Permalink to this definition"></a></dt>
<dd><p>User-defined way of calculating the likelihood of the observation stored in a cell.
In the case of a univariate observation, the user still has to define how the likelihood is calculated,
but has the ability to just return the output of a known scipy.stats.&lt;distribution&gt;.&lt;{pdf,pmf}&gt; function.
In the case of a multivariate observation, the user has to decide how the likelihood is calculated.
In our example, we assume the observation's are uncorrelated across the dimensions (across the different
distribution observations), so the likelihood of observing the multivariate observation is just the product of
the individual observation likelihoods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.ndarray</em>) -- </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.estimator">
<span class="sig-name descname"><span class="pre">estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammas</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.estimator" title="Permalink to this definition"></a></dt>
<dd><p>User-defined way of estimating the parameters given a list of the tuples of observations from a group of cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em>) -- </p></li>
<li><p><strong>gammas</strong> (<em>numpy.ndarray</em>) -- </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.assign_times">
<span class="sig-name descname"><span class="pre">assign_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_gens</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.assign_times" title="Permalink to this definition"></a></dt>
<dd><p>Assigns the start and end time for each cell in the lineage.
The time observation will be stored in the cell's observation parameter list
in the second position (index 1). See the other time functions to understand.
This is used in the creation of LineageTrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list_of_gens</strong> (<em>list</em>) -- </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.StateDistribution.censor_lineage">
<span class="sig-name descname"><span class="pre">censor_lineage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">censor_condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_list_of_gens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_lineage</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.StateDistribution.censor_lineage" title="Permalink to this definition"></a></dt>
<dd><p>This function removes those cells that are intended to be removed.
These cells include the descendants of a cell that has died, or has lived beyonf the experimental end time.
It takes in LineageTree object, walks through all the cells in the output binary tree,
applies the censorship to each cell that is supposed to be removed,
and returns the lineage of cells that are supposed to be alive and accounted for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>censor_condition</strong> (<em>int</em>) -- </p></li>
<li><p><strong>full_list_of_gens</strong> (<em>list</em>) -- </p></li>
<li><p><strong>full_lineage</strong> (<em>list</em>) -- </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.fate_censor">
<span class="sig-prename descclassname"><span class="pre">lineage.states.StateDistributionGamma.</span></span><span class="sig-name descname"><span class="pre">fate_censor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.fate_censor" title="Permalink to this definition"></a></dt>
<dd><p>Checks whether a cell has died based on its fate, and if so, it will remove its subtree.
Our example is based on the standard requirement that the first observation
(index 0) is a measure of the cell's fate (1 being alive, 0 being dead).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.time_censor">
<span class="sig-prename descclassname"><span class="pre">lineage.states.StateDistributionGamma.</span></span><span class="sig-name descname"><span class="pre">time_censor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_experiment_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.time_censor" title="Permalink to this definition"></a></dt>
<dd><p>Checks whether a cell has lived beyond the experiment end time and if so, it will remove its subtree.
Our example is based on the standard requirement that the second observation
(index 1) is a measure of the cell's lifetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>desired_experiment_time</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) -- </p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lineage.states.StateDistributionGamma.atonce_estimator">
<span class="sig-prename descclassname"><span class="pre">lineage.states.StateDistributionGamma.</span></span><span class="sig-name descname"><span class="pre">atonce_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_tHMMobj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammas_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lineage.states.StateDistributionGamma.atonce_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Estimating the parameters for one state, in this case bernoulli nad gamma distirbution parameters,
given a list of the tuples of observations from a group of cells.
gammas_list is only for one state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_tHMMobj</strong> (<em>list</em>) -- </p></li>
<li><p><strong>x_list</strong> (<em>list</em>) -- </p></li>
<li><p><strong>gammas_list</strong> (<em>list</em>) -- </p></li>
<li><p><strong>phase</strong> (<em>str</em>) -- </p></li>
<li><p><strong>state_j</strong> (<em>int</em>) -- </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Farnaz Mohammadi, JC Lagarde, Aaron S Meyer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
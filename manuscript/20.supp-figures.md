## Supplementary Figures

### Performance on uncensored lineages of increasing size

[//]: # (Supp. Figure 2)

![**Performance on uncensored single lineages of increasing size.** Single uncensored lineages with fate and time observations are simulated with two states. The time observations are gamma distributed with shape and scale parameters. Lineages are created synthetically and the model's performance in estimation and state assignment accuracy are plotted against the total number of cells in each lineage. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed in these plots. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Accuracies should approach 100% and errors should approach 0.](./output/figureS02.svg){#fig:ideal_2}

[//]: # (Supp. Figure 3)

![**Performance on uncensored populations of lineages of increasing number.** Populations of uncensored lineages with fate and time observations are simulated with two states. The time observations are gamma distributed with shape and scale parameters. The number of included lineages in the populations is increased and the total cell count is recorded. Populations (groups of lineages with fixed sized) are created and the model's performance in estimation and state assignment accuracy are plotted against the total cell count. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed. Horizontal markers of a lighter color (either light orange or light blue) represent the true value of that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS03.svg){#fig:ideal_3}

[//]: # (Supp. Figure 12)

![**Performance on uncensored single lineages of increasing size.** Single uncensored lineages with fate and time observations are simulated with two states. The time observations are exponentially distributed with a single scale parameter. Lineages are created and the model's performance in estimation and state assignment accuracy are plotted against the total number of cells in each lineage. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed in these plots. Horizontal markers of a lighter color (either light orange or light blue) represent the true value of that parameter. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Accuracies should approach 100% and errors should approach 0.](./output/figureS12.svg){#fig:ideal_12}

[//]: # (Supp. Figure 13)

![**Performance on uncensored populations of lineages of increasing number.** Populations of uncensored lineages with fate and time observations are simulated with two states. The number of included lineages in the populations is increased and the total cell count is recorded. Populations (groups of lineages with fixed size) are created and the model's performance in estimation and state assignment accuracy are plotted against the total cell count. The time observations are distributed exponentially parameterized by a single scale parameter. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed. Horizontal markers of a lighter color (either light orange or light blue) represent the true value of that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS13.svg){#fig:ideal_13}

[//]: # (Supp. Figure 22)

![**Performance on uncensored single lineages of increasing size.** Single uncensored lineages with fate and time observations are simulated with two states. Lineages are created and the model's performance in estimation and state assignment accuracy are plotted against the total number of cells in each lineage. Each cell contains four observations: the fate at the end of G1, the fate at the end of G2, and the lifetimes spent in G1 and G2. The lifetimes are each gamma distributed with shape and scale parameters. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed in these plots. Furthermore, cells that have died in G1 still have observations about their fate and lifetime in G2. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Horizontal markers of a lighter color (either light orange or light blue) represent the true value of that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS22.svg){#fig:ideal_22}

[//]: # (Supp. Figure 23)

![**Performance on uncensored populations of lineages of increasing number.** Populations of uncensored lineages with fate and time observations are simulated with two states. The number of included lineages in the populations is increased and the total cell count is recorded. The observations for cells in these lineages consist of a fate observation at the end of G1, a fate observation at the end of G2, and lifetime observations for time spent in G1 and time spent in G2, both of which are gamma distributed with shape and scale parameters. Populations (groups of lineages with fixed size) are created and the model's performance in estimation and state assignment accuracy are plotted against the total cell count. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed. Furthermore, cells that have died in G1 still have observations about their fate and lifetime in G2. Horizontal markers of a lighter color (either light orange or light blue) represent the true value of that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS23.svg){#fig:ideal_23}




### Performance on censored lineages of increasing size

[//]: # (Supp. Figure 4)

![**Performance on censored single lineages of increasing size.** Single censored lineages with fate and time observations are simulated with two states. The time observations are gamma distributed with shape and scale parameters. Lineages are created synthetically and the model's performance in estimation and state assignment accuracy are plotted. These lineages can represent real cells and real experimental data because cells that are daughters of cells that have died are not observed. Cells that live past the experiment time are also cut out from the synthetic lineage. In summary, cells that die or live past the desired experiment time have their subtrees (the sub-lineages created by their possible daughters) removed. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Accuracies should approach 100% and errors should approach 0.](./output/figureS04.svg){#fig:real_4}

[//]: # (Supp. Figure 5)

![**Performance on populations of censored lineages of increasing number.** Populations of censored lineages with fate and time observations are simulated with two states. The number of included lineages in the populations is increased and the total cell count is recorded. The time observations are gamma distributed with shape and scale parameters. Cells that die or live past the desired experiment time have their subtrees (the lineages created by their possible daughters) removed. Populations are created and the model's performance in estimation and state assignment accuracy are plotted against the total cell count. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS05.svg){#fig:real_5}

[//]: # (Supp. Figure 14)

![**Performance on uncensored single lineages of increasing size.** Single censored lineages with fate and time observations are simulated with two states. The time observations are exponentially distributed with a scale parameter. Lineages are created synthetically and the model's performance in estimation and state assignment accuracy are plotted against the total number of cells in each lineage. These lineages can represent real cells because cells that are daughters of cells that have died are not observed in these lineages. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Accuracies should approach 100% and errors should approach 0.](./output/figureS14.svg){#fig:real_14}

[//]: # (Supp. Figure 15)

![**Performance on populations of censored lineages of increasing number.** Populations of censored lineages with fate and time observations are simulated with two states. The number of included lineages in the populations is increased and the total cell count is recorded. The time observations are exponentially distributed. Cells that die or live past the desired experiment time have their subtrees (the lineages created by their possible daughters) are removed. Populations are created and the model's performance in estimation and state assignment accuracy are plotted against the total cell count. These lineages can represent real cells because cells that are daughters of cells that have died are not included in the observed lineage. Accuracies should approach 100% and errors should approach 0.](./output/figureS15.svg){#fig:real_15}

[//]: # (Supp. Figure 24)

![**Performance on censored single lineages of increasing size.** Single censored lineages with fate and time observations are simulated with two states. The observations for cells in these lineages consist of a fate observation at the end of G1, a fate observation at the end of G2, and lifetime observations for time spent in G1 and time spent in G2, both of which are gamma distributed with shape and scale parameters. Lineages are created synthetically and the model's performance in estimation and state assignment accuracy are plotted against the total cell number in each lineage. These lineages can represent real cells and real experiments because cells that are daughters of cells that have died are not observed in the lineages. Because it is difficult to estimate the mixing ratio (the probability of the initial cell belonging to a certain state) when working with only a single lineage, the model is given a fixed mixing ratio, such that it does not have to estimate it. As such, the error in estimating the initial probability vector, or the mixing ratio, is not presented. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS24.svg){#fig:real_24}

[//]: # (Supp. Figure 25)

![**Performance on populations of censored lineages of increasing number.** Populations of censored lineages with fate and time observations are simulated with two states. The number of included lineages in the populations is increased and the total cell count is recorded. The observations for cells in these lineages consist of a fate observation at the end of G1, a fate observation at the end of G2, and lifetime observations for time spent in G1 and time spent in G2, both of which are gamma distributed with shape and scale parameters. Cells that die or live past the desired experiment time have their subtrees (the lineages created by their possible daughters) are removed. In this case, cells can die in G1 or G2. Populations are created and the model's performance in estimation and state assignment accuracy are plotted. These lineages can represent real cells and real experiments because cells that are daughters of cells that have died are not included in the observed lineages. Horizontal markers of a lighter color (either light orange or light blue) represent the true value for that parameter. Accuracies should approach 100% and errors should approach 0.](./output/figureS25.svg){#fig:real_25}


TODO: Other supplemental figures

### Change in model performance when varying presence of state

![**Change in model performance when varying presence of state in uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. In particular, transition matrices initially bias cells to divide into only cells in the second state and force lineage trees to be entirely made of cells in the second state. A range of transition matrices are made that create lineages which bias the number of cells to be in one state or another. The proportion of cells in the first state in the lineage is recorded.](./output/figureS06.svg){#fig:prop6}

![**Change in model performance when varying presence of state in censored lineages.** Single censored lineages with fate and time observations are simulated with two states. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. The same experiment as before is replicated  The proportion of cells in the first state in the lineage is recorded.](./output/figureS07.svg){#fig:prop7}



### Change in model performance when varying state distribution similarity

![**Change in model performance when varying state distribution similarity with uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created in such a way that cells from each state are well represented in the lineage (the states are evenly distributed). One state is fixed and the other is allowed to vary in terms of its distribution. Initially, the two states are the same, i.e., they generate exactly the same distribution of cells. One of the states is then allowed to vary by increasing the gamma shape parameter. Doing so increases the Wassertein distance between the two states. Cells of each state from each lineage are sampled as distributions and are used to calculate the Wasserstein distance between the states. The Bernoulli parameter (a) and the gamma scale parameter (c) are the same for both of the states, but the gamma shape (b) parameter varies for the second state. The model is able to estimate the parameters of the states across all Wasserstein distances but has difficulty when the two states are nearly identical, when the Wasserstein distance between the states is low.](./output/figureS08.svg){#fig:wass1}

![**Change in model performance when varying state distribution similarity with censored lineages.** We perform the same experiment as above but with censored lineages.](./output/figureS09.svg){#fig:wass2}


### AIC Figure

some introduction...
![Model prediction accuracy on a simulated cell population with varying numbers of lineages. Accuracy of tHMM state assignment (left), Bernoulli parameter estimation (middle), and exponential parameter estimation (right) for populations of cells with different numbers of lineages. This is analogous to increasing the number of initial seeded cells. Lineages were composed of initially therapy sensitive (blue) that then later transitioned to resistant (orange) subpopulations. Dotted horizontal lines at target accuracy and true population values are depicted. Solid line represents a 10-point moving average. ...](./output/figureS10.svg){#fig:AIC}
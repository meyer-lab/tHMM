# Materials and Methods

## Cell Culture Experiments

### Cell Culture Set-up

To model a heterogeneous tumor, we conducted a proof-of-concept experiment by co-culturing cells derived from lung adenocarcinoma: PC-9 and H1299. These cells were obtained from the Meyer Lab at UCLA, where PC-9 cells were already transfected to fluoresce red through a H2B (histone h2b)-mKate2 nuclear localization lentivirus (Sigma-Aldrich, St. Louis, MO) and H1299 green through a H2B-GFP lentivirus (Sigma-Aldrich, St. Louis, MO). Before co-culturing, PC-9 and H1299 cells were grown separately in monolayers in tissue culture-treated well plates, using complete media (Roswell Park Memorial Institute media with L-glutamine (Thermo Fisher Scientific, Canoga Park, CA), supplemented with 5% fetal bovine serum (Corning, Corning, NY) and 1% penicillin/streptomycin (Thermo Fisher Scientific, Canoga Park, CA)). Similar conditions for the well plates and media were used for the co-culture experiment. Cells were passaged every 3 days and thrown out after 9 passages. Co-Culture Set-up and Imaging To co-culture PC-9 and H1299 cells, 200 PC-9 cells/cm2 and 200 H1299 cells/cm2 were taken from their respective well plates and seeded in complete media. Once seeded, cells were treated with 100 nM erlotinib (Selleckchem, Houston, TX), an epidermal growth factor receptor inhibitor which causes significant growth inhibition in PC-9 cells (IC50 = 7 nM) but not in H1299 cells (IC50 > 10 μM).34, 35 Cells were incubated in the Incucyte S3 Live-Cell Analysis System (Incucyte, Ann Arbor, MI) and imaged using phase contrast and fluorescent microscopy. The green channel excitation and emission ranges were 440-480 nm and 504-544 nm, respectively, whereas the red channel excitation and emission ranges were 565-605 nm and 625-705 nm, respectively. The exposure times were 300 ms for the green channel and 400 ms for the red channel. A 20x objective with a numerical aperture of 0.45 was used. Imaging started 24 hours after initial seeding to allow cells to
adhere, and images were acquired every 5 minutes for 4 days.

### Cell Tracking and Lineage Generation

To generate lineage trees from the acquired images, a cell image analysis software, ilastik (European Molecular Biology Laboratory, Heidelberg, Germany), was used to track the cells from the time-lapse datasets.36 Before inputting the imagesets into ilastik, Fiji’s ImageJ (NIH) Stackreg plugin was used to correct for in-plane drift.37 Moving to ilastik, pixel classification was used to segment the images, and we employed a tracking with deep learning workflow to training the program on true cell divisions and false detections. This allowed us to construct lineage tracks and link objects between frames. Upon running the pipeline to completion, the output was exported as a comma-separated values (CSV) file containing identification numbers for each cell and corresponding parent cells for each image. Using this CSV file, the parameters of interest, such as cell fate, longevity, and cell type were extracted using the Python programming language.

## Single state model

The first measurement is the cell's fate, encoded as $\phi$
## Discussion

The model failed to correctly classify only the cell that underwent the mutation prior to the onset of the resistant subpopulation. This sole incorrect classification demonstrates that the model may not be highly sensitive to immediate cell transitions, particularly if the phenotypic behaviors of the parent and daughter are relatively similar. However, the model proved efficacious both upstream and downstream of the transition, though may be less accurate on lineages with fewer cells. 

There are several lineages, however, on which the tHMM performed poorly, in particular the susceptible cells possessed high variance in parameter estimation. The deviations are also seen in the resistant cells, as some of the exponential estimates were orders of magnitude higher than the true value. The exponential estimator, similar to any other lifetime distribution, suffered from survivorship bias due to removal of unfinished cells that were still alive at the end of the tracking period and initial cells that failed to divide and create a lineage. Specifically, cells with longer lifetimes (i.e. higher growth rate) are more likely to live beyond the tracking period and thus are excluded from model estimation. This unavoidable phenomenon leads to the growth rate parameter approaching a value less than the true value (dotted line on figure) and biased yet precise estimation. Although Bernoulli estimations are centered around their respective true values, they suffer from survivorship bias as well because cells with higher Î¸_B divide more often and thus have a higher sample size for prediction. This leads to the resistant cell line possessing more accurate Bernoulli estimations relative to the susceptible subpopulation.

The tHMM accuracy performs maximum likelihood estimation using cell observations from each lineage in the population. Thus, the improved performance accuracy and decrease in its variance as lineage number increases validates the model architecture. Parameter estimation was poor on the onset, as the first two Bernoulli parameters for each state overlapped (as seen by the dark shaded circles), denoting that the model placed all cells into a single state. The separate subpopulations estimations were initially poor compared to true value, though the tHMM was able to better distinguish the separate subpopulations as more lineages were added.

In this work we present a machine learning pipeline, the tHMM, that can analyze tree-structured data using any measurements from the parent and daughter nodes. In particular, we apply our algorithm to a cell imaging protocol that inputs cell fate and lifetime into the tHMM pipeline and can be used with time-lapsed images for real-time classification. The tHMM is able to construct and analyze cell lineage trees to properly assign cells to different states based on solely two phenotypic properties of cell fitness, and also quantify the likelihood of transitioning to a different state using emissions and the transition rate matrix. The current version of this pipeline is most accurate when populations consist of at least 50 cells per lineage. We are working on making this model estimate hidden states for lineages that are much smaller, and with additional cell markers as emissions. Cell transitions from therapy-susceptible to therapy-resistant states are well detected by the model, which will prove useful for identifying mutant subtypes in tumors and leading to more optimal therapies for cancer treatment. The tHMM may further be used for drug screening as a single-cell, rather than population-based, means of quantifying potency of novel therapies in eliminating all subpopulations within a tumor. The pipeline will provide researchers and clinicians with improved classification of heterogeneity among cells, or any other tree-structured data, and provide information about latent changes in cellular identity.


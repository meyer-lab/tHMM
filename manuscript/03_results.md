## Results

### Simulated Lineage

some introduction...

![**Distribution of alive cells in resistant and susceptible states over time and generation.** The distribution of alive cells in susceptible and resistant states after pruning the lineage, based on the parameterization including initial probability ${\pi = [0.6, 0.4]}$, transition probability matrix $[[0.85, 0.15],[0.15, 0.85]]$ with ${(p, shape, scale) = (0.99, 20, 5)}$ for resistant cells, and ${(p, shape, scale) = (0.88, 10, 1)}$ for susciptable cells. **a** and **c** show the number of cells over generations and time, and **b** and **d** show the proportion of those over generation and time, respectively.](./output/figure1.svg){#fig:Distributions}


### Heterogeneous model with 1 lineage per population

![Model prediction accuracy a simulated heterogeneous lineage. There is only one lineage per population. Nodes in blue represent therapy-susceptible cells with parameters of ${(p, shape, scale) = (0.88, 10, 1)}$. Nodes in orange are therapy-resistant cancerous cells with parameters of ${(p, shape, scale) = (0.99, 20, 5)}$. The upper row shows the estimation of the emission distributions, including bernoulli paramter, gamma shape, and gamma scale. Estimation accuracy of the Bernoulli parameter **a**, shape parameter of Gamma distribution **b**, and scale parameter of Gamma distribution **c**. The lower row exhibits the accuracy of model parameters, including state prediction of cells **d**, accuracy of initial probability estimation **e**, estimation accuracy of state transition probability matrix **f** for a range of cell numbers.](./output/figure3.svg){#fig:heterog1Model}


### Heterogeneous model with more than 1 lineage per population

![Model prediction accuracy a simulated heterogeneous lineage with more than 1 lineage per population. Nodes in blue represent therapy-susceptible cells with parameters of ${(p, shape, scale) = (0.88, 10, 1)}$. Nodes in orange are therapy-resistant cancerous cells with parameters of ${(p, shape, scale) = (0.99, 20, 5)}$. The upper row shows the estimation of the emission distributions, including bernoulli paramter, gamma shape, and gamma scale. Estimation accuracy of the Bernoulli parameter **a**, shape parameter of Gamma distribution **b**, and scale parameter of Gamma distribution **c**. The lower row exhibits the accuracy of model parameters, including state prediction of cells **d**, accuracy of initial probability estimation **e**, estimation accuracy of state transition probability matrix **f** for a range of cell numbers.](./output/figure4.svg){#fig:heteroMultiModel}


### Performance based on varying proportion of state

![**Performance based on varying proportion of state in uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=\begin{pmatrix}{0.5 \\ 0.5}\end{pmatrix}}$ and with $2^{12}-1$ cells. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. In particular, transition matrices initially start out as ${T=\begin{pmatrix}{0 & 1 \\ 0 & 1}\end{pmatrix}}$ which bias cells to divide into only cells in the second state and force lineage trees to be entirely made of cells in the second state. A range of values are generated by linearly interpolating between $0$ and $1$, and the set of transition matrices ${\{\begin{pmatrix}{i & 1-i \\ i & 1-1}\end{pmatrix}} | i\in\{0,\ldots,1\}\}$ is created. These transition matrices create lineages which bias the number of cells to be in one state or another. The proportion of cells in the first state in the lineage is recorded.](./output/figure6.svg){#fig:prop1}

![**Performance based on varying proportion of state in censored lineages.** Single censored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=\begin{pmatrix}{0.5 \\ 0.5}\end{pmatrix}}$ and with $2^{12}-1$ cells which are then censored; if a cell dies or lives past the maximum experimental time, then its subtrees are removed. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. In particular, transition matrices initially start out as ${T=\begin{pmatrix}{0 & 1 \\ 0 & 1}\end{pmatrix}}$ which bias cells to divide into only cells in the second state and force lineage trees to be entirely made of cells in the second state. A range of values are generated by linearly interpolating between $0$ and $1$, and the set of transition matrices ${\{\begin{pmatrix}{i & 1-i \\ i & 1-1}\end{pmatrix}} | i\in\{0,\ldots,1\}\}$ is created. These transition matrices create lineages which bias the number of cells to be in one state or another. The proportion of cells in the first state in the lineage is recorded.](./output/figure6.svg){#fig:prop1}


### Performance based on varying distribution similarity

![**Performance based on varying distribution similarity with uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=\begin{pmatrix}{0.5 \\ 0.5}\end{pmatrix}}$ and ${T=\begin{pmatrix}{0 & 1 \\ 1 & 0}\end{pmatrix}}$ and with $2^{12}-1$ cells to ensure that cells from each state are well represented in the lineage. One state is fixed and the other is allowed to vary in terms of its distribution. Initially, the two states are the same, i.e., they generate exactly the same distribution of cells. One of the states is then allowed to vary by increasing the gamma shape parameter. Doing so increases the Wassertein distance between the two states. Cells of each state from each lineage are sampled as distributions and are used to calculate the Wasserstein distance between the states. The Bernoulli parameter (a) and the gamma scale parameter (c) are the same for both of the states, but the gamma shape (b) parameter varies for the second state. The model is able to estimate the parameters of the states across all Wasserstein distances but has difficulty when the two states are nearly identical, when the Wasserstein distance between the states is low.](./output/figure8.svg){#fig:wass1}

![**Performance based on varying distribution similarity with censored lineages.** Single censored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=\begin{pmatrix}{0.5 \\ 0.5}\end{pmatrix}}$ and ${T=\begin{pmatrix}{0 & 1 \\ 1 & 0}\end{pmatrix}}$ and with $2^{12}-1$ cells to ensure that cells from each state are well represented in the lineage just as before. These lineages are then censored; cells that die or live longer than the maximum experimental time have their subtrees removed. As before, one state is fixed and the other is allowed to vary in terms of its distribution. The two states are initally the same, i.e., they generate exactly the same distribution of cells. One of the states is then allowed to vary by increasing the gamma shape parameter. Doing so increases the Wassertein distance between the two states. Cells of each state from each lineage are sampled as distributions and are used to calculate the Wasserstein distance between the states. Note that the measured Wasserstein distance between the observed cells is not exactly the true distance between the state distributions due to the censure of cells in the lineages, i.e, the sample of cells is *not* representative of the true state distributions. The Bernoulli parameter (a) and the gamma scale parameter (c) are the same for both of the states, but the gamma shape (b) parameter varies for the second lineage. The model is able to estimate the parameters of the states across all Wasserstein distances but has difficulty when the two states are identical, when the Wasserstein distance between the states is $0$.](./output/figure9.svg){#fig:wass2}


### AIC Figure

some introduction...
![Model prediction accuracy on a simulated cell population with varying numbers of lineages. Accuracy of tHMM state assignment (left), Bernoulli parameter estimation (middle), and exponential parameter estimation (right) for populations of cells with different numbers of lineages. This is analogous to increasing the number of initial seeded cells. Lineages were composed of initially therapy sensitive (blue) that then later transitioned to resistant (orange) subpopulations. Dotted horizontal lines at target accuracy and true population values are depicted. Solid line represents a 10-point moving average. ...](./output/figure10.svg){#fig:AIC}
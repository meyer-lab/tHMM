## Results

[//]: # (Figure 0)

![blah00](./output/figure0.svg){#fig:blah0}

[//]: # (Figure 1)

![blah01](./output/figure1.svg){#fig:blah1}



### Performance on uncensored lineages of increasing size

[//]: # (Figure 2)

![**Performance on uncensored single lineages of increasing sizes.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$, with ${T=(0.85 & 0.15 \\ 0.15 & 0.85)}$. Lineages are created with 16 to 128 cells and the model's performance in estimation and state assignment accuracy are plotted. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed.](./output/figure2.svg){#fig:ideal2}

[//]: # (Figure 3)

![**Performance on uncensored populations of lineages of increasing number.** Populations of uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$, with ${T=(0.85 & 0.15 \\0.15 & 0.85)}$, and each lineage with $16$ cells. Populations are created with 1 to 100 lineages and the model's performance in estimation and state assignment accuracy are plotted. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed.](./output/figure3.svg){#fig:ideal3}



### Performance on censored lineages of increasing size

[//]: # (Figure 4)

![**Performance on censored single lineages of increasing sizes by increasing experiment time.** Single censored lineages with fate and time observations are simulated with two states. Cells that die or live past the desired experiment time have their subtrees (the lineages created by their possible daughters) are removed. These lineages are created with ${\pi=(0.5 0.5)}$, with ${T=(0.85 & 0.15 \\ 0.15 & 0.85)}$. Lineages are created with experiment time of 72 to 144 hours and the model's performance in estimation and state assignment accuracy are plotted.](./output/figure4.svg){#fig:censor4}

[//]: # (Figure 5)

![**Performance on populations of censored lineages of increasing number.** Populations of uncensored lineages with fate and time observations are simulated with two states. Cells that die or live past the desired experiment time have their subtrees (the lineages created by their possible daughters) are removed. These lineages are created with ${\pi=(0.5 0.5)}$, with ${T=(0.85 & 0.15 \\ 0.15 & 0.85)}$, and each lineage is created with an experiment time of 72 hours. Populations are created with 1 to 100 lineages and the model's performance in estimation and state assignment accuracy are plotted. These lineages cannot represent real cells because cells that are daughters of cells that have died are observed.](./output/figure5.svg){#fig:censor5}



### Change in model performance when varying presence of state

![**Change in model performance when varying presence of state in uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$ and with $2^{12}-1$ cells. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. In particular, transition matrices initially start out as ${T=(0 & 1 \\ 0 & 1)}$ which bias cells to divide into only cells in the second state and force lineage trees to be entirely made of cells in the second state. A range of values are generated by linearly interpolating between $0$ and $1$, and the set of transition matrices $\{i & 1-i \\ i & 1-i | i \in \{0,\ldots,1\}\}$ is created. These transition matrices create lineages which bias the number of cells to be in one state or another. The proportion of cells in the first state in the lineage is recorded.](./output/figure6.svg){#fig:prop6}

![**Change in model performance when varying presence of state in censored lineages.** Single censored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$ and with $2^{12}-1$ cells which are then censored; if a cell dies or lives past the maximum experimental time, then its subtrees are removed. The transition matrices that generate these lineages are varied such that the relative proportion of cells in each state vary. In particular, transition matrices initially start out as ${T=(0 & 1 \\ 0 & 1)}$ which bias cells to divide into only cells in the second state and force lineage trees to be entirely made of cells in the second state. A range of values are generated by linearly interpolating between $0$ and $1$, and the set of transition matrices $\{i & 1-i \\ i & 1-i | i \in \{0,\ldots,1\}\}$ is created. These transition matrices create lineages which bias the number of cells to be in one state or another. The proportion of cells in the first state in the lineage is recorded.](./output/figure7.svg){#fig:prop7}



### Change in model performance when varying state distribution similarity

![**Change in model performance when varying state distribution similarity with uncensored lineages.** Single uncensored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$ and ${T=(0 & 1 \\ 0 & 1)}$ and with $2^{12}-1$ cells to ensure that cells from each state are well represented in the lineage. One state is fixed and the other is allowed to vary in terms of its distribution. Initially, the two states are the same, i.e., they generate exactly the same distribution of cells. One of the states is then allowed to vary by increasing the gamma shape parameter. Doing so increases the Wassertein distance between the two states. Cells of each state from each lineage are sampled as distributions and are used to calculate the Wasserstein distance between the states. The Bernoulli parameter (a) and the gamma scale parameter (c) are the same for both of the states, but the gamma shape (b) parameter varies for the second state. The model is able to estimate the parameters of the states across all Wasserstein distances but has difficulty when the two states are nearly identical, when the Wasserstein distance between the states is low.](./output/figure8.svg){#fig:wass1}

![**Change in model performance when varying state distribution similarity with censored lineages.** Single censored lineages with fate and time observations are simulated with two states. These lineages are created with ${\pi=(0.5 0.5)}$ and ${T=(0 & 1 \\ 0 & 1)}$ and with $2^{12}-1$ cells to ensure that cells from each state are well represented in the lineage just as before. These lineages are then censored; cells that die or live longer than the maximum experimental time have their subtrees removed. As before, one state is fixed and the other is allowed to vary in terms of its distribution. The two states are initally the same, i.e., they generate exactly the same distribution of cells. One of the states is then allowed to vary by increasing the gamma shape parameter. Doing so increases the Wassertein distance between the two states. Cells of each state from each lineage are sampled as distributions and are used to calculate the Wasserstein distance between the states. Note that the measured Wasserstein distance between the observed cells is not exactly the true distance between the state distributions due to the censure of cells in the lineages, i.e, the sample of cells is *not* representative of the true state distributions. The Bernoulli parameter (a) and the gamma scale parameter (c) are the same for both of the states, but the gamma shape (b) parameter varies for the second lineage. The model is able to estimate the parameters of the states across all Wasserstein distances but has difficulty when the two states are identical, when the Wasserstein distance between the states is $0$.](./output/figure9.svg){#fig:wass2}


### AIC Figure

some introduction...
![Model prediction accuracy on a simulated cell population with varying numbers of lineages. Accuracy of tHMM state assignment (left), Bernoulli parameter estimation (middle), and exponential parameter estimation (right) for populations of cells with different numbers of lineages. This is analogous to increasing the number of initial seeded cells. Lineages were composed of initially therapy sensitive (blue) that then later transitioned to resistant (orange) subpopulations. Dotted horizontal lines at target accuracy and true population values are depicted. Solid line represents a 10-point moving average. ...](./output/figure10.svg){#fig:AIC}
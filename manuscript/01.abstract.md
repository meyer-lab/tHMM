## Abstract {.page_break_before}

Cell plasticity, or the ability of cells within a population to reversibly alter their phenotype, is an important feature of tissue homeostasis during processes such as wound healing and cancer. Plasticity operates alongside other sources of cell-to-cell heterogeneity such as genetic mutations and variation in signaling. Ultimately these processes prevent most cancer therapies from being curative. The predominant methods of quantifying tumor-drug response operate on snapshot population-level measurements and therefore lack evolutionary dynamics, which are particularly critical for dynamic processes such as plasticity. Here we apply a tree-based adaptation of a hidden Markov model (tHMM) that employs single cell lineages as input to learn the characteristic patterns of single cell heterogeneity and state transitions in an unsupervised fashion. This model enables single cell classification based on the phenotype of individual cells and their relatives for improved specificity in pinpointing the structure and dynamics of variability in drug response. Integrating this model with a modular interface for defining observed phenotypes allows the model to easily be adapted to any phenotype measured in single cells. To benchmark our model, we paired cell fate with either cell lifetimes or individual cell cycle phase lengths (G1 and S/G2) as our observed phenotypes on synthetic data and demonstrated that the model successfully classifies cells within experimentally tractable dataset sizes. As an application, we analyzed experimental measurements of cell fate and phase duration in cancer cell populations treated with chemotherapies to determine the number of distinct subpopulations. In total, this tHMM framework allows for the flexible classification of single cell heterogeneity across lineages.

## Summary points

<!-- ASM proofed. -->

- A lineage tree-based hidden Markov model (tHMM) quantifies cell-to-cell variability and dynamic population changes.
- A modular interface to define phenotypes allows the model to work with any single cell phenotypic measurements.
- The model accurately classifies cells within experimentally tractable dataset sizes.
- Classifying cells based on their phenotypic heterogeneity and relationships uncovers dynamics hidden at the population level.

## Author Summary

<!-- ASM proofed. -->

Heterogeneous traits, such as resistance or susceptibility to a drug, can be correlated in related cells because of shared or inherited factors. These acquired traits may be the result of the microenvironment, epigenetics, or mutations. Using cellsâ€™ relationships we capture these dynamic transitions between different cell states and arrive at a more accurate quantification of cell heterogeneity within tumor populations compared to clustering such as K-means that ignores any relationship between the individuals. Our computational approach employing a modified hidden Markov model provides greater specificity by identifying intratumor heterogeneity on a single cell level based on lineage histories and can identify dynamic changes in population structure upon treatment.

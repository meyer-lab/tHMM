## Abstract {.page_break_before}

Cell plasticity, or the ability of cells within a population to reversibly alter epigenetic state, is an important feature of tissue homeostasis during processes such as wound healing and is dysregulated in cancer. Plasticity is linked to other sources of cell-cell heterogeneity, including genetic mutations and variation in signaling during drug-resistance development. Ultimately these mechanisms prevent most cancer therapies from being curative. The predominant methods of quantifying tumor-drug response operate on population-level measurements and therefore lack evolutionary dynamics, which are particularly critical for highly dynamic processes such as plasticity. Here, we apply a tree-based adaptation of a hidden Markov model (tHMM) that employs single cell lineages as input, to learn characteristic patterns of single cell heterogeneity and state transitions in an unsupervised fashion. This model enables single cell classification based on the phenotype of individual cells and their relatives for improved specificity when pinpointing the molecular drivers of variability in drug response. Integrating this model with a probabilistic language for defining observed phenotypes allows the model to easily be adapted to other phenotypes. We paired cell fate with either cell lifetimes or cell cycle phase lengths (G1 and S/G2) as our observed phenotypes on synthetic data and demonstrated that the model successfully classifies cells within experimentally-tractable dataset sizes. As an application, we analyzed an experimental data of cell fate and phase lengths observations to determine the number of distinct subpopulations. In total, this tHMM framework allows for flexible classification of single cell heterogeneity of heritable traits across lineages.

## Summary points

- A tree-based hidden Markov model (tHMM) captures cell-cell variability and dynamic population changes.
- Using a probabilistic language to define observed phenotypes allows the model to work with a wide variety of single cell measurements.
- The model successfully classifies cells within experimentally-tractable dataset sizes.
- Classifying cells based on their phenotypic heterogeneity can uncover resistance mechanisms masked at the population level.

## Author Summary

Cell heterogeneity, such as variability in drug response, arises as cells proliferate. Shared heterogeneous traits, like a shared response to a drug such as resistance or susceptibility within a subpopulation, are correlated across a lineage because resistant subpopulations most likely diverged from a common progenitor or a set of common progenitors that were also resistant or had acquired traits leading to resistance. These acquired traits of resistance may be the result of responses to cellular microenvironments, epigenetics, or mutations. Using lineage tree information, we capture these dynamic transitions between different latent states of cells and arrive at a more accurate identification of cell heterogeneity in a tumor population. Our computational approach employing modified hidden Markov models provides higher specificity by identifying intratumor resistance on an single cell level based on lineage histories and enables real-time identification of changes in resistance throughout therapy.
